<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Core Wars</title>

  <script src="thrift.js"         type="text/javascript"></script>
  <script src="mars_types.js"     type="text/javascript"></script>
  <script src="MARS.js"           type="text/javascript"></script>

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>


  <script type="text/javascript" charset="utf-8">
  var transport;
  var protocol;
  var client;
  var message;
  $(document).ready(function(){
     transport = new Thrift.TXHRTransport("http://localhost:9090");
     protocol  = new Thrift.TJSONProtocol(transport);
     client    = new MARS.MARSClient(protocol);
  });

  function waitForMessage() {
      message = client.sendMessage();
  }
  function sendCode() {
      var c = new MARS.Code();
      c.code = document.getElementById("code_text").value;
      if (c.code) {
        transport.open();
        client.receiveFromJS(c);
        waitForMessage();
        alert(message);
        transport.close();
      }
  }
  </script>

</head>
<body>
  <h2>Thrift test</h2>
  <textarea id="code_text" cols="50" rows="20"></textarea>
      <!-- <td><input type="textarea" cols="50" rows="20" id="code_text" value=""/></td> -->
    <tr>
      <td><input type="button" id="send_button" value="send code" onclick="sendCode();"/></td>
    </tr>
</body>
</html>
